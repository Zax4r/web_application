{% extends 'base.html' %}

{% block title %}
Тесты
{% endblock %}


{% block content %}
    <h1>Добавить новый тест</h1>
    <form action="/tests" method="POST" class="adding" autocomplete="off">
        <label for="title">Название теста</label>
        <input type="text" id="title" name="title" required><br><br>

        <label for="max_questions">Кол-во вопросов</label>
        <input type="number" id="max_questions" name="max_questions" required  required min="1" step="1"><br><br>

        <label for="teacher_index">Выбрать учителя:</label>
        <select id="teacher_index" name="teacher_index" required>
            {% for teacher in teachers %}
                <option value="{{ loop.index0 }}">{{ teacher.name }}</option>
            {% endfor %}
        </select><br><br>

        <input type="submit" value="Добавить">
    </form>


    <h1>Тесты:</h1>

<div>
    {% for test in tests %}
    <div class = 'list_element'>
        {{test.title}} ({{test.max_questions}} вопроса)
            {% if test.is_draft %}
            <form action="/tests/{{ loop.index0 }}/activate" method="POST" style="display:inline;">
                <input type="submit" value="Активировать">
            </form>
            {% elif test.is_tested %}  
            <form action="/tests/{{ loop.index0 }}/convert" method="POST" style="display:inline;">
                <input type="submit" value="Конвертировать">
            </form>
                
            <details> 
                <summary>Результаты</summary>
    
                <span>
                {% for student,test_result in test.test_results.items() %}
    
                    <li>{{ student.name }}: {{test_result}}</li>
    
                {% endfor %}
                </span>
            </details>

            {% else %}
            <form action="/tests/{{ loop.index0 }}/check" method="POST" style="display:inline;">
                <input type="submit" value="Выставить">
            </form>

            <details> 
                <summary>Результаты</summary>
    
                <span>
                {% for student,mark in test.marks.items() %}
    
                    <li>{{ student.name }}: {{mark}}</li>
    
                {% endfor %}
                </span>
            </details>

            {% endif %} 
            <form class = 'deletion' action="/tests/{{ loop.index0 }}/delete" method="POST" style="display:inline;">
                <input type="submit" value="Удалить">
            </form>
    </div>
    {% endfor %}
</div>
{% endblock %}